{"version":3,"file":"js/736.bd61d447.js","mappings":"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","sources":["webpack://chinese_myths/./src/views/Login.vue","webpack://chinese_myths/src/views/Login.vue","webpack://chinese_myths/./src/views/Login.vue?7d1c","webpack://chinese_myths/./src/views/Login.vue?a6ee"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"login_container\"},[_c('div',{staticClass:\"img\"}),_c('el-tabs',{staticClass:\"login_box\",attrs:{\"before-leave\":_vm.resetForm},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"密码登录\",\"name\":\"login\"}},[_c('el-form',{ref:\"loginFormRef\",staticClass:\"login_form\",attrs:{\"model\":_vm.loginForm,\"rules\":_vm.loginFormRules,\"hide-required-asterisk\":true,\"inline\":true}},[_c('el-form-item',{attrs:{\"label\":\"账号\",\"prop\":\"username\"}},[_c('el-input',{staticClass:\"el-form-item-inp\",attrs:{\"placeholder\":\"请输入账号\"},model:{value:(_vm.loginForm.username),callback:function ($$v) {_vm.$set(_vm.loginForm, \"username\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"loginForm.username\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"password\",\"label\":\"密码\"}},[_c('el-input',{staticClass:\"el-form-item-inp\",attrs:{\"placeholder\":\"请输入密码\",\"type\":\"password\"},model:{value:(_vm.loginForm.password),callback:function ($$v) {_vm.$set(_vm.loginForm, \"password\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"loginForm.password\"}})],1),_c('el-form-item',{staticClass:\"btns el-form-item-inp\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.login('loginFormRef', _vm.loginForm)}}},[_vm._v(\"登录\")]),_c('el-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.toSignUp}},[_vm._v(\"注册\")])],1)],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"login_container\">\n    <div class=\"img\"></div>\n    <el-tabs v-model=\"activeName\" class=\"login_box\" :before-leave=\"resetForm\">\n      <!-- 密码登录面板 -->\n      <el-tab-pane label=\"密码登录\" name=\"login\">\n        <el-form\n          class=\"login_form\"\n          :model=\"loginForm\"\n          :rules=\"loginFormRules\"\n          :hide-required-asterisk=\"true\"\n          :inline=\"true\"\n          ref=\"loginFormRef\"\n        >\n          <!-- 用户名 -->\n          <el-form-item label=\"账号\" prop=\"username\">\n            <el-input\n              class=\"el-form-item-inp\"\n              placeholder=\"请输入账号\"\n              v-model.trim=\"loginForm.username\"\n            ></el-input>\n          </el-form-item>\n          <!-- 密码 -->\n          <el-form-item prop=\"password\" label=\"密码\">\n            <el-input\n              class=\"el-form-item-inp\"\n              placeholder=\"请输入密码\"\n              v-model.trim=\"loginForm.password\"\n              type=\"password\"\n            ></el-input>\n          </el-form-item>\n          <!-- 提交按钮 -->\n          <el-form-item class=\"btns el-form-item-inp\">\n            <el-button type=\"primary\" @click=\"login('loginFormRef', loginForm)\"\n              >登录</el-button\n            >\n            <el-button type=\"info\" @click=\"toSignUp\">注册</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane>\n      <!-- 短信登录面板 -->\n      <!-- <el-tab-pane label=\"短信登录\" name=\"sms\">\n        <el-form\n          class=\"login_form\"\n          :model=\"smsForm\"\n          :rules=\"smsFormRules\"\n          :hide-required-asterisk=\"true\"\n          :inline=\"true\"\n          ref=\"smsFormRef\"\n        > -->\n      <!-- 用户名 -->\n      <!-- <el-form-item label=\"手机号\" prop=\"phone\">\n            <el-input\n              class=\"el-form-item-inp\"\n              placeholder=\"请输入手机号\"\n              v-model=\"smsForm.phone\"\n            ></el-input>\n          </el-form-item> -->\n      <!-- 密码 -->\n      <!-- <el-form-item prop=\"securityCode\" label=\"验证码\">\n            <el-input\n              class=\"el-form-item-inp\"\n              placeholder=\"请输入验证码\"\n              maxlength=\"4\"\n              v-model=\"smsForm.securityCode\"\n            ></el-input>\n            <el-button\n              :disabled=\"disabled\"\n              class=\"sms\"\n              type=\"text\"\n              @click=\"validateBtn\"\n              >{{ codeValue }}</el-button\n            >\n          </el-form-item> -->\n      <!-- 提交按钮 -->\n      <!-- <el-form-item class=\"btns el-form-item-inp\">\n            <el-button type=\"primary\" @click=\"getVerifyCode\">登录</el-button>\n            <el-button type=\"info\" @click=\"toSignUp\">注册</el-button>\n          </el-form-item>\n        </el-form>\n      </el-tab-pane> -->\n    </el-tabs>\n  </div>\n</template>\n\n<script>\nimport { login, loginforphone } from '@/api/services/loginUser.services';\n// import axios from 'axios'\nexport default {\n  data() {\n    // 验证手机号的规则\n    const checkMobile = (rule, value, cb) => {\n      if (!value) cb(new Error('请输入手机号'));\n      // 验证手机号的正则表达式\n      const regMobile =\n        /^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;\n      if (regMobile.test(value)) {\n        return cb();\n      }\n      cb(new Error('请输入合法的手机号'));\n    };\n    // 验证验证码的规则\n    const checkCode = (rule, value, cb) => {\n      if (!value) cb(new Error('请输入验证码'));\n      if (this.smsForm.phone && value === this.smsForm.securityCode) {\n        return cb();\n      }\n      cb(new Error('验证码错误'));\n    };\n    return {\n      // 当前显示标签页\n      activeName: 'login',\n      // 登录表单的数据绑定\n      loginForm: {\n        username: '',\n        password: '',\n      },\n      // 短信表单的数据绑定\n      smsForm: {\n        phone: '',\n        securityCode: '',\n      },\n      // 自定义验证码\n      myCode: '',\n      // 发送验证码是否禁用绑定\n      disabled: false,\n      // 验证码按钮内容绑定\n      codeValue: '获取验证码',\n      // 登录验证规则\n      loginFormRules: {\n        username: [\n          { required: true, message: '请输入用户名', trigger: 'blur' },\n          {\n            min: 3,\n            max: 100,\n            message: '长度在 3 到 8 个字符',\n            trigger: 'blur',\n          },\n        ],\n        password: [\n          { required: true, message: '请输入密码', trigger: 'blur' },\n          {\n            min: 3,\n            max: 150,\n            message: '长度在 6 到 15 个字符',\n            trigger: 'blur',\n          },\n        ],\n      },\n      // 短信验证规则\n      smsFormRules: {\n        phone: [{ validator: checkMobile, trigger: 'blur' }],\n        securityCode: [{ validator: checkCode, trigger: 'blur' }],\n      },\n    };\n  },\n  methods: {\n    // 登录预验证\n    login(formRef, form) {\n      this.$refs[formRef].validate(async (valid) => {\n        // 判空\n        if (!valid) return;\n        const data = await login(form);\n        console.log(data);\n        // 弹窗提示\n        if (data && data.status === 200) {\n          this.$message.success('登录成功');\n          this.saveUser(data);\n          return;\n        }\n        if (data && data.status === 40001)\n          return this.$message.error('网站出问题了，请等会在试吧！');\n        if (!data.status) return;\n        this.$message.error(data.msg);\n      });\n    },\n    // 重置表单验证\n    resetForm(activeName) {\n      if (activeName === 'sms') return this.$refs.loginFormRef.resetFields();\n      if (activeName === 'login') return this.$refs.smsFormRef.resetFields();\n    },\n    // 发送验证码\n    getVerifyCode() {\n      this.$refs.smsFormRef.validateField('phone', async (valid) => {\n        // 判断手机号是否正确\n        if (valid) return;\n        const data = await loginforphone(this.smsForm);\n        // 弹窗提示\n        if (data.status === 404)\n          return this.$message.error('当前手机号还没注册');\n        if (data.status === 409) return this.$message.error('验证码错误');\n        this.$message.success('登录成功');\n        this.saveUser(data);\n      });\n    },\n    // 验证码按钮\n    validateBtn() {\n      let time = 60;\n      this.$message.success('获取验证码成功');\n      const timer = setInterval(() => {\n        if (time === 0) {\n          clearInterval(timer);\n          this.codeValue = '获取验证码';\n          this.disabled = false;\n        } else {\n          // 倒计时\n          this.codeValue = time + '秒后重试';\n          this.disabled = true;\n          time--;\n        }\n      }, 1000);\n    },\n    // 跳转到注册页面\n    toSignUp() {\n      this.$router.push('/SignUp');\n    },\n    // 登录成功保存用户信息\n    saveUser(data) {\n      // 存储用户信息\n      // data.account.timestamp = data.account.registrationTime\n      // delete data.account.registrationTime\n      console.log(data);\n      this.$store.commit('loginUser', {\n        user: data.data,\n        token: data.token,\n      });\n      if (data.data.role) return this.$router.push('/backstage');\n      this.$router.push('/home');\n    },\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.login_container {\n  display: flex;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  height: 80vh;\n  min-height: 500px;\n  min-width: 880px;\n  width: 70%;\n  transform: translate(-50%, -50%);\n  background-color: #fff;\n  border: 1px solid var(--common_line_light_color, rgba(126, 134, 142, 0.16));\n  box-shadow: 0 4px 14px 0 rgb(126 134 142 / 16%);\n  .img {\n    flex: 1 0 auto;\n    width: 0;\n    height: 100%;\n    background: url('../assets/login.svg') 80% no-repeat;\n    background-size: 80%;\n    --tw-bg-opacity: 1;\n    background-color: rgb(249 250 251 / var(--tw-bg-opacity));\n  }\n}\n.login_box {\n  flex: 1 0 auto;\n  width: 0;\n  margin: 25px 40px;\n  // margin-right: 10%;\n  background-color: #fff;\n  .login_form {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    align-items: center;\n    height: 300px;\n    // width: 80%;\n    margin-top: 80px;\n    .sms {\n      position: absolute;\n      top: 0;\n      right: 15px;\n    }\n    .el-form-item-inp {\n      width: 350px;\n    }\n  }\n}\n\n.btns {\n  button {\n    width: 100px;\n    margin: 0 36px;\n  }\n  .el-button--info {\n    // margin-left: 20%;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Login.vue?vue&type=template&id=f862e29c&scoped=true&\"\nimport script from \"./Login.vue?vue&type=script&lang=js&\"\nexport * from \"./Login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Login.vue?vue&type=style&index=0&id=f862e29c&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f862e29c\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","resetForm","model","value","activeName","callback","$$v","expression","ref","loginForm","loginFormRules","username","$set","trim","password","on","$event","login","_v","toSignUp","staticRenderFns","data","cb","smsForm","phone","securityCode","myCode","disabled","codeValue","required","message","trigger","min","max","smsFormRules","validator","methods","console","getVerifyCode","validateBtn","clearInterval","time","saveUser","user","token","component"],"sourceRoot":""}