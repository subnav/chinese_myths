"use strict";(self["webpackChunkchinese_myths"]=self["webpackChunkchinese_myths"]||[]).push([[640],{7640:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("el-form",{ref:"form",attrs:{model:e.user,rules:e.rules,"label-width":"80px"}},[t("h2",{staticClass:"Info-title"},[e._v("我的资料")]),t("img",{attrs:{src:e.$store.state.user.portrait,alt:""}}),t("el-form-item",{attrs:{label:"用户名:",prop:"username"}},[t("el-input",{staticClass:"min-width",attrs:{placeholder:"你的昵称"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),t("el-form-item",{attrs:{label:"手机号:",prop:"phone"}},[t("el-input",{staticClass:"min-width",attrs:{placeholder:"你的手机号"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),t("el-form-item",{attrs:{label:"邮箱:",prop:"email"}},[t("el-input",{staticClass:"min-width",attrs:{placeholder:"你的邮箱"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),t("el-form-item",{attrs:{label:"我的签名:"}},[t("el-input",{staticClass:"textarea",attrs:{type:"textarea",rows:"4",maxlength:"30","show-word-limit":"",placeholder:"填写简介让大家更容易认识自己(๑╹ヮ╹๑)ﾉ",resize:"none",size:"medium"},model:{value:e.user.introduction,callback:function(t){e.$set(e.user,"introduction",t)},expression:"user.introduction"}})],1),t("el-divider"),t("el-button",{staticClass:"user-info-save",attrs:{type:"primary",disabled:e.disabled},on:{click:e.updateInfo}},[e._v("保存")])],1)},a=[],i=s(2104),o={data(){const e=(e,t,s)=>{if(!t)return s(new Error("用户名不能为空"));s()},t=(e,t,s)=>{if(!t)return s(new Error("手机号不能为空"));const r=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(r.test(t))return s();s(new Error("请输入合法的手机号"))};return{rules:{username:[{required:!0,validator:e,trigger:"blur"}],phone:[{required:!0,validator:t,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},user:{phone:"",username:"",email:"",introduction:""}}},created(){const e=window.localStorage.getItem("token");e&&this.updateUser(e)},methods:{async updateUser(e){const t=await(0,i.LE)(e);console.log(t,987),t.data&&(console.log(t.data,243),this.$store.commit("loginUser",{user:t.data,token:localStorage.getItem("token")}),this.user={...this.$store.state.user},console.log(this.user,this.$store.state.user,675),this.$message.success("获取信息成功"))},updateInfo(){this.$refs.form.validate((async e=>{if(!e)return;this.user.token=this.$store.state.token,this.user.introduction||delete this.user.introduction,console.log(this.user);const t=await(0,i.rn)(this.user);if(console.log(t.data),!t.data&&200!==t.state)return this.$message.error("修改信息失败");this.$store.commit("updateInfo",this.user),this.$message.success("修改信息成功")}))}},computed:{disabled(){return JSON.stringify(this.user)===JSON.stringify(this.$store.state.user)}}},l=o,n=s(1001),u=(0,n.Z)(l,r,a,!1,null,"5f19dbfc",null),c=u.exports}}]);
//# sourceMappingURL=640.a5974622.js.map