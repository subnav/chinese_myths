"use strict";(self["webpackChunkchinese_myths"]=self["webpackChunkchinese_myths"]||[]).push([[460],{460:function(t,e,i){i.r(e),i.d(e,{default:function(){return d}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box-container"},[e("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",{attrs:{to:{path:"/bghome"}}},[t._v("首页")]),e("el-breadcrumb-item",[t._v("板块管理")]),e("el-breadcrumb-item",[t._v("帖子详情")])],1),e("el-card",{staticClass:"box-card"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.filter((e=>!t.search||e.name.toLowerCase().includes(t.search.toLowerCase())||e.intro.toLowerCase().includes(t.search.toLowerCase()))),"default-sort":{prop:"date",order:"descending"}}},[e("el-table-column",{attrs:{prop:"sid",label:"板块",align:"center",sortable:"",width:"80"},scopedSlots:t._u([{key:"default",fn:function(i){return[1===i.row.sid?e("span",[t._v("创世神话")]):2===i.row.sid?e("span",[t._v("英雄神话")]):e("span",[t._v("自然神话")])]}}])}),e("el-table-column",{attrs:{prop:"name",label:"帖子",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tag",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(i.row.name))])]}}])}),e("el-table-column",{attrs:{prop:"intro",label:"人物简介",align:"center",width:"340"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(t._f("ellipsis")(i.row.intro)))])]}}])}),e("el-table-column",{attrs:{prop:"story",label:"人物故事",align:"center",width:"340"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("span",[t._v(t._s(t._f("ellipsis")(i.row.story)))])]}}])}),e("el-table-column",{attrs:{align:"right",prop:"address",formatter:t.formatter},scopedSlots:t._u([{key:"header",fn:function(i){return[e("el-input",{attrs:{size:"mini",clearable:"",placeholder:"输入关键字搜索"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]}},{key:"default",fn:function(i){return[e("el-tooltip",{attrs:{content:"查看",placement:"top"}},[e("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.PlateListEdit(i.$index,i.row)}}})],1),e("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.PlateListeDelete(i.$index,i.row.sid,i.row.pid)}}})]}}])})],1),e("div",{staticClass:"block",staticStyle:{"text-align":"center","margin-top":"15px"}},[e("el-button",{staticClass:"add el-icon-plus",attrs:{type:"primary",size:"mini"},on:{click:t.plateListAdd}},[t._v("添加")])],1)],1),e("el-dialog",{attrs:{title:"帖子详情",visible:t.centerDialogVisible,width:"60%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[e("el-form",{ref:"detail",attrs:{model:t.detail,rules:t.rules,"label-width":"80px"}},[e("el-form-item",{attrs:{label:"主题",prop:"name"}},[e("el-input",{model:{value:t.detail.name,callback:function(e){t.$set(t.detail,"name",e)},expression:"detail.name"}})],1),e("el-form-item",{attrs:{label:"板块区域",prop:"sid"}},[e("el-select",{attrs:{placeholder:"请选择板块区域"},model:{value:t.detail.sid,callback:function(e){t.$set(t.detail,"sid",e)},expression:"detail.sid"}},[e("el-option",{attrs:{label:"创世神话",value:"1"}}),e("el-option",{attrs:{label:"英雄神话",value:"2"}}),e("el-option",{attrs:{label:"自然神话",value:"3"}})],1)],1),e("el-form-item",{attrs:{label:"图画",prop:"portrait"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost:3000/getImgPath","show-file-list":!1,"list-type":"picture-card",multiple:!1,limit:1,"auto-upload":!0,"on-success":t.handle_success,accept:"image/png, image/jpg, image/jpeg"},model:{value:t.detail.portrait,callback:function(e){t.$set(t.detail,"portrait",e)},expression:"detail.portrait"}},[e("div",[this.detail.portrait?e("img",{staticClass:"avatar",attrs:{src:this.detail.portrait}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])])],1),e("el-form-item",{attrs:{label:"人物简介",prop:"intro"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:6},maxlength:"255","show-word-limit":""},model:{value:t.detail.intro,callback:function(e){t.$set(t.detail,"intro",e)},expression:"detail.intro"}})],1),e("el-form-item",{attrs:{label:"人物故事",prop:"story"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:6},maxlength:"255","show-word-limit":""},model:{value:t.detail.story,callback:function(e){t.$set(t.detail,"story",e)},expression:"detail.story"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleCancel}},[t._v("取 消")]),e("el-button",{attrs:{disabled:t.isDisabled,type:"primary"},on:{click:function(e){return t.handlerPost(t.detail)}}},[t._v("确 定")])],1)],1)],1)},s=[],l=i(2761),r={name:"plate-list",data(){return{search:"",centerDialogVisible:!1,detail:{},detailCopy:{sid:"",name:"",intro:"",story:""},tableData:[],fileList:[{id:"1",portrait:"https://img1.baidu.com/it/u=1659441821,1293635445&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500"}],isDisabled:!0,isAdd:0,rules:{name:[{required:!0,message:"请输入主题名称",trigger:"blur"},{min:1,message:"长度至少大于 1 个字符",trigger:"blur"}],sid:[{required:!0,message:"请选择板块区域",trigger:"change"}],portrait:{required:!0,message:"图画不能为空"},intro:[{required:!0,message:"请输入内容",trigger:"blur"},{min:1,max:255,message:"长度至少大于 1 个字符",trigger:"blur"}],story:[{required:!0,message:"请输入内容",trigger:"blur"},{min:1,max:255,message:"长度至少大于 1 个字符",trigger:"blur"}]}}},watch:{detail:{deep:!0,handler(t,e){console.log(JSON.stringify(this.detailCopy)!==JSON.stringify(t),this.detailCopy),JSON.stringify(this.detailCopy)!==JSON.stringify(t)?this.isDisabled=!1:this.isDisabled=!0}}},created(){const t=this.$loading({lock:!0,text:"数据加载中......",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});setTimeout((()=>{t.close()}),1e3)},filters:{ellipsis(t){return t?t.length>50?t.slice(0,48)+"...":t:""}},mounted(){this.getAllPostInfo()},methods:{async getAllPostInfo(t,e){const i=await(0,l.x1)();return console.log(i),200===i.status?this.tableData=i.data:this.$message.error("获取数据失败！")},PlateListEdit(t,e){this.centerDialogVisible=!0,this.detail={...e},this.detailCopy={...e}},plateListAdd(){this.detail={},this.centerDialogVisible=!0,this.detail.isAdd=1,this.detailCopy.isAdd=1},handleCancel(){this.centerDialogVisible=!1,this.detail.isAdd&&(this.detail.isAdd=0,this.detailCopy.isAdd=0)},async PlateListeDelete(t,e,i){const a=await this.$confirm("确定要删除此帖子吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((t=>t));if("confirm"!==a)return this.$message.info("已取消删除");const s=await(0,l.Xh)(e,i);return console.log(s),200===s.status?(console.log(t),this.tableData.splice(t,1),this.$message.success("删除成功！")):this.$message.error("删除失败！")},deleteLabel(t){const e=/<\/?.+?\/?>/g;return t.replace(e,"")},async handlerPost(t){console.log(t);const e=await(0,l.CP)(t);if(200===e.status)return this.centerDialogVisible=!1,this.$message.success(e.msg),this.getAllPostInfo();this.$message.error("失败！")},formatter(t,e){return console.log(t),t.address},handle_success(t){console.log(t,2),200===t.status?(this.$message.success("图片上传成功"),this.detail.portrait=t.data.url,console.log(this.detail.portrait)):this.$message.success("图片上传失败")}}},o=r,n=i(1001),c=(0,n.Z)(o,a,s,!1,null,"6b8c7a8a",null),d=c.exports},2761:function(t,e,i){i.d(e,{CP:function(){return m},Cy:function(){return u},GP:function(){return c},Xh:function(){return g},Y8:function(){return l},h8:function(){return n},jl:function(){return s},qC:function(){return h},qG:function(){return d},sl:function(){return o},x1:function(){return p},z2:function(){return r}});var a=i(8859);const s=()=>(0,a.v)("/getAllData"),l=(t,e)=>(0,a.v)("/getAllUser",{uid:t,token:e}),r=t=>(0,a.v)("/register",t),o=(t,e,i,s,{email:l,password:r,phone:o,role:n,uid:c,username:d})=>(0,a.v)("updataInfoByAdmin",{email:l,password:r,phone:o,role:n,uid:c,username:d,token:t,adminId:e,adminPwd:i,adminUser:s}),n=t=>(0,a.v)("/deleteUser",{uid:t}),c=t=>(0,a.v)("delectSection",{sid:t}),d=t=>(0,a.v)("addSection",t),u=()=>(0,a.v)("getAllSections"),p=()=>(0,a.v)("getAllPost"),m=t=>(0,a.v)("updatePost",t),g=(t,e)=>(0,a.v)("goToRecycle",{sid:t,pid:e}),h=(t,e)=>(0,a.v)("noneRecycle",{uid:t,pid:e})}}]);
//# sourceMappingURL=460.f58428f3.js.map