"use strict";(self["webpackChunkchinese_myths"]=self["webpackChunkchinese_myths"]||[]).push([[736],{7736:function(e,s,r){r.r(s),r.d(s,{default:function(){return u}});var t=function(){var e=this,s=e._self._c;return s("div",{staticClass:"login_container"},[s("div",{staticClass:"img"}),s("el-tabs",{staticClass:"login_box",attrs:{"before-leave":e.resetForm},model:{value:e.activeName,callback:function(s){e.activeName=s},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"密码登录",name:"login"}},[s("el-form",{ref:"loginFormRef",staticClass:"login_form",attrs:{model:e.loginForm,rules:e.loginFormRules,"hide-required-asterisk":!0,inline:!0}},[s("el-form-item",{attrs:{label:"账号",prop:"username"}},[s("el-input",{staticClass:"el-form-item-inp",attrs:{placeholder:"请输入账号"},model:{value:e.loginForm.username,callback:function(s){e.$set(e.loginForm,"username","string"===typeof s?s.trim():s)},expression:"loginForm.username"}})],1),s("el-form-item",{attrs:{prop:"password",label:"密码"}},[s("el-input",{staticClass:"el-form-item-inp",attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.loginForm.password,callback:function(s){e.$set(e.loginForm,"password","string"===typeof s?s.trim():s)},expression:"loginForm.password"}})],1),s("el-form-item",{staticClass:"btns el-form-item-inp"},[s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.login("loginFormRef",e.loginForm)}}},[e._v("登录")]),s("el-button",{attrs:{type:"info"},on:{click:e.toSignUp}},[e._v("注册")])],1)],1)],1)],1)],1)},i=[],o=(r(7658),r(2104)),a={data(){const e=(e,s,r)=>{s||r(new Error("请输入手机号"));const t=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(t.test(s))return r();r(new Error("请输入合法的手机号"))},s=(e,s,r)=>{if(s||r(new Error("请输入验证码")),this.smsForm.phone&&s===this.smsForm.securityCode)return r();r(new Error("验证码错误"))};return{activeName:"login",loginForm:{username:"",password:""},smsForm:{phone:"",securityCode:""},myCode:"",disabled:!1,codeValue:"获取验证码",loginFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:100,message:"长度在 3 到 8 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:3,max:150,message:"长度在 6 到 15 个字符",trigger:"blur"}]},smsFormRules:{phone:[{validator:e,trigger:"blur"}],securityCode:[{validator:s,trigger:"blur"}]}}},methods:{login(e,s){this.$refs[e].validate((async e=>{if(!e)return;const r=await(0,o.x4)(s);return console.log(r),r&&200===r.status?(this.$message.success("登录成功"),void this.saveUser(r)):r&&40001===r.status?this.$message.error("网站出问题了，请等会在试吧！"):void(r.status&&this.$message.error(r.msg))}))},resetForm(e){return"sms"===e?this.$refs.loginFormRef.resetFields():"login"===e?this.$refs.smsFormRef.resetFields():void 0},getVerifyCode(){this.$refs.smsFormRef.validateField("phone",(async e=>{if(e)return;const s=await(0,o.j3)(this.smsForm);return 404===s.status?this.$message.error("当前手机号还没注册"):409===s.status?this.$message.error("验证码错误"):(this.$message.success("登录成功"),void this.saveUser(s))}))},validateBtn(){let e=60;this.$message.success("获取验证码成功");const s=setInterval((()=>{0===e?(clearInterval(s),this.codeValue="获取验证码",this.disabled=!1):(this.codeValue=e+"秒后重试",this.disabled=!0,e--)}),1e3)},toSignUp(){this.$router.push("/SignUp")},saveUser(e){if(console.log(e),this.$store.commit("loginUser",{user:e.data,token:e.token}),e.data.role)return this.$router.push("/backstage");this.$router.push("/home")}}},l=a,n=r(1001),m=(0,n.Z)(l,t,i,!1,null,"f862e29c",null),u=m.exports}}]);
//# sourceMappingURL=736.bd61d447.js.map