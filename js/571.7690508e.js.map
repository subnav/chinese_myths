{"version":3,"file":"js/571.7690508e.js","mappings":"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","sources":["webpack://chinese_myths/./src/views/user/UpdatePwd.vue","webpack://chinese_myths/src/views/user/UpdatePwd.vue","webpack://chinese_myths/./src/views/user/UpdatePwd.vue?94a1","webpack://chinese_myths/./src/views/user/UpdatePwd.vue?9d87"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"user-password\"},[_c('h2',{staticClass:\"Info-title\"},[_vm._v(\"修改密码\")]),_c('div',{staticClass:\"tips\"},[_c('el-tag',{attrs:{\"type\":\"warning\",\"effect\":\"plain\"}},[_vm._v(\"为了安全，我们强烈建议您选择与其他在线账户不同的独一无二密码。\")])],1),_c('div',{staticClass:\"main\"},[_c('el-form',{ref:\"updatePwdForm\",staticClass:\"updatePwdForm\",attrs:{\"model\":_vm.updatePwdForm,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"label\":\"原始密码\",\"prop\":\"oldPwd\"}},[_c('el-input',{model:{value:(_vm.updatePwdForm.oldPwd),callback:function ($$v) {_vm.$set(_vm.updatePwdForm, \"oldPwd\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"updatePwdForm.oldPwd\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"prop\":\"newPwd\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"off\"},model:{value:(_vm.updatePwdForm.newPwd),callback:function ($$v) {_vm.$set(_vm.updatePwdForm, \"newPwd\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"updatePwdForm.newPwd\"}})],1),_c('el-form-item',{attrs:{\"label\":\"确认密码\",\"prop\":\"checkPass\"}},[_c('el-input',{attrs:{\"type\":\"password\",\"autocomplete\":\"off\"},model:{value:(_vm.updatePwdForm.checkPass),callback:function ($$v) {_vm.$set(_vm.updatePwdForm, \"checkPass\", (typeof $$v === 'string'? $$v.trim(): $$v))},expression:\"updatePwdForm.checkPass\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.resetLoginForm}},[_vm._v(\"放弃更改\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.updatePwd}},[_vm._v(\"保存变更\")])],1)],1),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_vm._m(0)],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('ul',[_c('li',[_vm._v(\"您的密码\")]),_c('li',[_vm._v(\"您的密码必须由 7 个或更多字符组成。\")]),_c('li',[_vm._v(\"您的密码必须包含至少 1 位数字\")]),_c('li',[_vm._v(\"您的密码不得含有空格\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"user-password\">\n    <h2 class=\"Info-title\">修改密码</h2>\n    <div class=\"tips\">\n      <el-tag type=\"warning\" effect=\"plain\">为了安全，我们强烈建议您选择与其他在线账户不同的独一无二密码。</el-tag>\n    </div>\n    <div class=\"main\">\n      <!-- 密码板块 -->\n      <el-form\n        class=\"updatePwdForm\"\n        :model=\"updatePwdForm\"\n        :rules=\"rules\"\n        ref=\"updatePwdForm\">\n        <!-- 用户名 -->\n        <el-form-item label=\"原始密码\" prop=\"oldPwd\">\n          <el-input v-model.trim=\"updatePwdForm.oldPwd\"></el-input>\n        </el-form-item>\n        <!-- 密码 -->\n        <el-form-item label=\"密码\" prop=\"newPwd\">\n          <el-input type=\"password\" v-model.trim=\"updatePwdForm.newPwd\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <!-- 确认密码 -->\n        <el-form-item label=\"确认密码\" prop=\"checkPass\">\n          <el-input type=\"password\" v-model.trim=\"updatePwdForm.checkPass\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <!-- 提交按钮 -->\n        <el-form-item>\n          <el-button type=\"info\" @click=\"resetLoginForm\">放弃更改</el-button>\n          <el-button type=\"primary\" @click=\"updatePwd\">保存变更</el-button>\n        </el-form-item>\n      </el-form>\n      <el-divider direction=\"vertical\"></el-divider>\n      <!-- 文字提示 -->\n      <ul>\n        <li>您的密码</li>\n        <li>您的密码必须由 7 个或更多字符组成。</li>\n        <li>您的密码必须包含至少 1 位数字</li>\n        <li>您的密码不得含有空格</li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport { updateUserPwd } from '@/api/services/loginUser.services'\nexport default {\n  data () {\n    // 验证当前密码\n    const oldPwd = (rule, value, callback) => {\n      if (!value) callback(new Error('当前密码不能为空'))\n      console.log(this.$store.state.user.password,value);\n      if (value !== this.$store.state.user.password) callback(new Error('密码错误，请重新输入'))\n      callback()\n    }\n    // 验证密码\n    const newPwd = (rule, value, callback) => {\n      if (!value) callback(new Error('密码不能为空'))\n      if (this.updatePwdForm.checkPass) this.$refs.updatePwdForm.validateField('checkPass')\n      callback()\n    }\n    // 验证确认密码\n    const checkPass = (rule, value, callback) => {\n      if (!value) callback(new Error('请再次输入密码'))\n      if (value !== this.updatePwdForm.newPwd) callback(new Error('两次输入密码不一致!'))\n      callback()\n    }\n    return {\n      // 密码表单的数据绑定\n      updatePwdForm: {\n        oldPwd: '',\n        newPwd: '',\n        checkPass: ''\n      },\n      // 表单验证规则\n      rules: {\n        oldPwd: [\n          { validator: oldPwd, trigger: 'blur' }\n        ],\n        newPwd: [\n          { validator: newPwd, trigger: 'blur' }\n        ],\n        checkPass: [\n          { validator: checkPass, trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  computed: {\n    ...mapState(['user', 'token'])\n  },\n  methods: {\n    // 重置方法\n    resetLoginForm () {\n      this.$refs.updatePwdForm.resetFields()\n    },\n    // 登录预验证\n    updatePwd () {\n      this.$refs.updatePwdForm.validate(async valid => {\n        // 判空\n        if (!valid) return\n        const data = await updateUserPwd(this.user.username, this.updatePwdForm, this.token)\n        console.log(data)\n        // 弹窗提示\n        if (data.status !== 200) return this.$message.error('更换密码失败')\n        this.$message.success(data.msg)\n        // 更新信息\n        this.$store.commit('updatePwd', {\n          user: data.data,\n          token: data.token\n        })\n        window.localStorage.setItem('token', data.token)\n        this.$refs.updatePwdForm.resetFields()\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  .el-tag {\n    margin-bottom: 40px;\n    font-size: 14px;\n  }\n  .updatePwdForm {\n    width: 40%;\n    .el-button {\n      margin: 10px 0 0 20px;\n    }\n  }\n  .main {\n    display: flex;\n    justify-content: space-between;\n    .el-divider {\n      height: 300px;\n    }\n    li {\n      width: 300px;\n      font-size: 16px;\n      color: gray;\n      padding: 18px 0;\n    }\n  }\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdatePwd.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdatePwd.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdatePwd.vue?vue&type=template&id=586fa170&scoped=true&\"\nimport script from \"./UpdatePwd.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdatePwd.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpdatePwd.vue?vue&type=style&index=0&id=586fa170&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"586fa170\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_v","attrs","ref","updatePwdForm","rules","model","value","oldPwd","callback","$$v","$set","trim","expression","newPwd","checkPass","on","resetLoginForm","updatePwd","_m","staticRenderFns","data","console","validator","trigger","computed","methods","user","token","window","component"],"sourceRoot":""}